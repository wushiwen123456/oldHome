(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/ShopDetails/shopDetails"],{"409c":function(t,e,i){"use strict";(function(t,o){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,s=i("2f62"),a=i("74d3"),r=i("0307"),c=i("8404"),u=l(i("d7df"));function l(t){return t&&t.__esModule?t:{default:t}}function f(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},o=Object.keys(i);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),o.forEach(function(e){g(t,e,i[e])})}return t}function h(t){return d(t)||m(t)||p()}function p(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function m(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function d(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}function g(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var I=function(){return i.e("components/numberbox/numberbox").then(i.bind(null,"1875"))},v=function(){return i.e("components/uni-popup/uni-popup").then(i.bind(null,"11ec"))},y={components:{uniPopup:v,tuiNumberbox:I},data:function(){var t;return{payimgType:!0,swiperNum:0,videoUrl:"",swiperList:[],getCurrentList:[],list:[],value:1,shareList:[],itemInfo:(t={price:"",oldPrice:"",count:"",ficti:"",sales:0,cost:"",isHot:"",isPostage:!1,isSeckill:!1,isGroup:!1,userCollect:!1},g(t,"count",""),g(t,"name",""),g(t,"type",[]),g(t,"count",0),g(t,"totalTypes",[]),g(t,"image",""),g(t,"id",""),g(t,"stock",""),g(t,"unique",""),g(t,"id",""),g(t,"is_bargain",""),g(t,"video",""),t),storeInfo:{info:{expressageFen:"",produceFen:"",serviceFen:"",totalFen:"",storeName:"",storeLogo:"",storeId:""},shopFans:""},recommend:[],discount:{},autoplay:!1,commont:{}}},onLoad:function(e){e.id?(this.$store.commit("keepShopId",e.id),console.log(t(this.$store.state.shopId," at pages\\ShopDetails\\shopDetails.vue:384")),this._getDetailData(e.id)):o.switchTab({url:"../Home/home"}),n=this},onShow:function(){""==this.$store.state.shopId&&o.switchTab({url:"../Home/home"})},onBackPress:function(){if(nvImageMenu.isVisible())return nvImageMenu.hide(),nvMask.hide(),!0},methods:{_getDetailData:function(t){var e=this;this.isToken||o.showModal({title:"需要登陆才能查看，是否去登陆？",content:"isLogin?",success:function(t){t.confirm?o.switchTab({url:"../login/login"}):o.switchTab({url:"../Home/home"})}}),(0,a.getDetailData)(t,this.isToken).then(function(t){var i=t.data.data.storeInfo;i.slider_image=i.slider_image.map(function(t){return(0,r.replaceImage)(t)}),e.dealSwiper(i),e.itemInfo.id=i.id,e.itemInfo.price=i.price,e.itemInfo.oldPrice=i.ot_price,e.itemInfo.count=parseInt(i.give_integral),e.itemInfo.ficti=i.ficti,e.itemInfo.cost=i.cost,e.itemInfo.isHot=i.is_hot,e.itemInfo.isPostage=i.is_postage,e.itemInfo.isSeckill=i.is_seckill,e.itemInfo.isGroup=i.is_group,e.itemInfo.userCollect=i.userCollect,e.itemInfo.name=i.store_name,e.itemInfo.sales=i.sales,e.itemInfo.image=(0,r.replaceImage)(i.image),e.itemInfo.stock=i.stock,e.itemInfo.is_group=i.is_group,e.itemInfo.is_bargain=i.is_bargain,e.itemInfo.video=(0,r.replaceImage)(i.video),e.list=h(t.data.data.productAttr),e.itemInfo.totalTypes=t.data.data.productValue;var o=t.data.data.shop_info;e.storeInfo.info.expressageFen=o.expressage_score,e.storeInfo.info.produceFen=o.product_score,e.storeInfo.info.serviceFen=o.service_score,e.storeInfo.info.storeId=o.shop_id,e.storeInfo.info.storeLogo=(0,r.replaceImage)(o.shop_logo),e.storeInfo.info.storeName=o.shop_name,e.storeInfo.info.totalFen=o.zong,e.recommend=t.data.data.recommend_goods;(0,r.replaceList)(t.data.data.recommend_goods);e.recommend.forEach(function(t){t.image=(0,r.replaceImage)(t.image)}),e.getShopDiscount(e.storeInfo.info.storeId,e.isToken);var n=t.data.data.reply;e.dealCommont(n)})},dealSwiper:function(t){this.swiperList=t.slider_image.map(function(t,e){return{url:t,id:e,type:"image"}}),this.itemInfo.video&&(this.videoContext=o.createVideoContext("myVideo",this))},selectShopClick:function(t,e,i){t.check?t.check=!1:(this.list[i].attr_value.forEach(function(t){t.check=!1}),t.check=!0),this.itemInfo.type=[],this.getCurrent()},getCurrent:function(){var t=this;if(!this.list)return[];var e=this.list.map(function(t){return t.attr_value.filter(function(t){return t.check})});e.forEach(function(e){e.length&&t.itemInfo.type.push(e[0].attr)})},selectimageClick:function(){0==this.swiperNum&&(this.payimgType=!1,this.ZhanTing())},selectPlayClick:function(){0!=this.swiperNum&&(this.payimgType=!0,this.BoFang())},swiperChange:function(t){this.swiperNum=t.target.current},serviceClick:function(){var t=JSON.stringify(this.storeInfo.info);o.navigateTo({url:"informtion/informtion?shopInfo="+t})},change:function(t){this.value=t.value},goMoreCommont:function(){var t=this.itemInfo.id;o.navigateTo({url:"shopComment?id=".concat(t)})},nowBuyClick:function(){var e=this;if(this.isToken)if(Object.keys(this.itemInfo.totalTypes).length){var i=this.itemInfo.totalTypes[this.itemInfo.type];if(void 0!==i){this.itemInfo.unique=i.unique;var n={productId:this.itemInfo.id,cartNum:this.value,shop_id:this.storeInfo.info.storeId,uniqueId:this.itemInfo.unique,combinationId:"",secKillId:"",bargainId:""};(0,a.payNow)(n,this.isToken).then(function(i){if(console.log(t(i," at pages\\ShopDetails\\shopDetails.vue:607")),200==i.data.code){e.$store.commit("keepCartId",i.data.data.cartId);var n=e.$store.state.pinkInfo;Object.keys(n).length&&e.$store.commit("setOutPinkInfo"),o.navigateTo({url:"affirm/affirmOrder"})}else 400==i.data.code&&o.showToast({title:"商品不存在或已删除",icon:"none"})})}else o.showToast({title:"请选择商品种类",icon:"none"})}else{this.itemInfo.unique="";var s={productId:this.itemInfo.id,cartNum:this.value,shop_id:this.storeInfo.info.storeId,uniqueId:this.itemInfo.unique,combinationId:"",secKillId:"",bargainId:""};(0,a.payNow)(s,this.isToken).then(function(t){200==t.data.code?(e.$store.commit("keepCartId",t.data.data.cartId),o.navigateTo({url:"affirm/affirmOrder"})):400==t.data.code&&o.showToast({title:"商品不存在或已删除",icon:"none"})})}else o.switchTab({url:"../Home/home"})},swiperDetail:function(){var e=this.swiperList.slice(1,this.swiperList.length-1);e=e.map(function(t){return t.url}),console.log(t(e," at pages\\ShopDetails\\shopDetails.vue:675")),plus.nativeUI.previewImage(e)},openImage:function(){var t=this.showImgUrl||"";t&&plus.nativeUI.previewImage([t])},dealCommont:function(e){if(e){var i=e.pics.map(function(t){return(0,r.replaceImage)(t)});e.pics=i,e.avatar=(0,r.replaceImage)(e.avatar),this.commont=e}console.log(t(e," at pages\\ShopDetails\\shopDetails.vue:699")),console.log(t(this.commont," at pages\\ShopDetails\\shopDetails.vue:700"))},collectClick:function(e){var i,n=this;console.log(t(this.itemInfo," at pages\\ShopDetails\\shopDetails.vue:705")),this.itemInfo.isSeckill||this.itemInfo.isGroup||this.itemInfo.is_bargain?(this.itemInfo.isSeckill&&(i="seckill"),this.itemInfo.isGroup&&(i="pink"),this.itemInfo.bargain&&(i="bargain")):i="product",this.itemInfo.userCollect?(0,a.unCollectProduct)(this.itemInfo.id,i,this.isToken).then(function(t){200==t.data.code&&(o.showToast({title:"已取消收藏",icon:"none"}),n.itemInfo.userCollect=!1)}):(0,a.collectProduct)(this.itemInfo.id,i,this.isToken).then(function(e){200==e.data.code&&(console.log(t(e," at pages\\ShopDetails\\shopDetails.vue:722")),o.showToast({title:"收藏成功",icon:"none"}),n.itemInfo.userCollect=!0)})},isClick:function(){o.navigateTo({url:"aaa"})},shopClick:function(){o.navigateTo({url:"StoreDetails/storedetails?id="+this.storeInfo.info.storeId})},outloginClick:function(){this.$refs.popups.open()},closePopupsClick:function(){this.$refs.popups.close()},goDetail:function(t){(0,c.clickDetail)(t)},outloginSharClick:function(){var e=this,i={href:"https://uniapp.dcloud.io",title:"老家商城",desc:"老家商城，我的家就是你的家",imgUrl:"/static/56524a9a3b6bdab0753eb8ed922d57d.png"};this.shareObj=(0,u.default)(i,this.shareList,function(e){console.log(t("点击按钮的序号: "+e," at pages\\ShopDetails\\shopDetails.vue:779"));var n={href:i.href||"",title:i.title||"",summary:i.desc||"",success:function(e){console.log(t("success:"+JSON.stringify(e)," at pages\\ShopDetails\\shopDetails.vue:785"))},fail:function(e){console.log(t("fail:"+JSON.stringify(e)," at pages\\ShopDetails\\shopDetails.vue:788"))}};switch(e){case 0:n.provider="weixin",n.scene="WXSceneSession",n.type=0,n.imageUrl=i.imgUrl||"",o.share(n);break;case 1:n.provider="weixin",n.scene="WXSenceTimeline",n.type=0,n.imageUrl=i.imgUrl||"",o.share(n);break;case 2:o.setClipboardData({data:i.href,complete:function(){o.showToast({title:"已复制到剪贴板"})}});break;case 3:plus.share.sendWithSystem({type:"web",title:i.title||"",thumbs:[i.imgUrl||""],href:i.href||"",content:i.desc||""});break}}),this.$nextTick(function(){e.shareObj.alphaBg.show(),e.shareObj.shareMenu.show()})},closePopupsSharClick:function(){this.$refs.popup.close()},outloginShopClick:function(){this.$refs.popupbottom.open()},closePopupsShopClick:function(){this.$refs.popupbottom.close()},chooseClose:function(){this.$refs.popupbottom.close()},recommClick:function(t,e){o.navigateTo({url:"./shopDetails?id=".concat(t.id)})},addCart:function(){var e=this;if(this.isToken)if(Object.keys(this.itemInfo.totalTypes).length){var i=this.itemInfo.totalTypes[this.itemInfo.type];if(void 0!==i){this.itemInfo.unique=i.unique;var n={productId:this.itemInfo.id,cartNum:this.value,uniqueId:this.itemInfo.unique,shop_id:this.storeInfo.info.storeId};(0,a.getAddCart)(n,this.isToken).then(function(i){console.log(t(i," at pages\\ShopDetails\\shopDetails.vue:879")),200==i.data.code&&(plus.nativeUI.toast("添加成功"),e.$store.commit("addCart",n))}),this.$refs.popupbottom.close()}else o.showToast({title:"请选择商品种类",icon:"none"})}else{this.itemInfo.unique="";var s={productId:this.itemInfo.id,cartNum:this.value,uniqueId:this.itemInfo.unique,shop_id:this.storeInfo.info.storeId};(0,a.getAddCart)(s,this.isToken).then(function(i){console.log(t(i," at pages\\ShopDetails\\shopDetails.vue:906")),200==i.data.code&&(plus.nativeUI.toast("添加成功"),e.$store.commit("addCart",s))}),this.$refs.popupbottom.close()}else o.navigateTo({url:"../login/login"})},isChooseType:function(){if(this.itemInfo.type){var t=this.itemInfo.type;return this.list.length==t.length?this.itemInfo.totalTypes[t]?this.itemInfo.totalTypes[t].suk:"":t.join(",")}return""},getShopDiscount:function(e,i){var o=this;(0,a.getShopDiscount)(e,i).then(function(e){200==e.data.code&&(console.log(t(e," at pages\\ShopDetails\\shopDetails.vue:943")),o.discount=e.data.data,console.log(t(o.discount," at pages\\ShopDetails\\shopDetails.vue:945")))})},isCountClass:function(t){return!!t.is_use},isCount:function(t){return t.is_use?"已领取":1!=parseInt(t.is_permanent)?0==t.total_count?"已抢光":"立即领取":void 0},goLingqu:function(t){"立即领取"==this.isCount(t)&&(0,a.getDisCount)(t.id,this.isToken).then(function(e){200==e.data.code&&(t.is_use=!0,o.showToast({title:e.data.msg,icon:"none"}))})},BoFang:function(){0==n.autoplay&&(n.autoplay=!0,this.videoContext.play())},ZhanTing:function(){1==n.autoplay&&(n.autoplay=!1)}},computed:f({},(0,s.mapGetters)(["isToken"]),{isUserCollect:function(){return this.itemInfo.userCollect?"已收藏":"收藏"},isVideo:function(){return!this.swiperList.every(function(t){return"image"==t.type})},showImgUrl:function(){if(this.itemInfo.totalTypes)return this.itemInfo.type.length&&this.itemInfo.totalTypes[this.itemInfo.type.join(",")]?(0,r.replaceImage)(this.itemInfo.totalTypes[this.itemInfo.type.join(",")].image):(0,r.replaceImage)(this.itemInfo.image)},selectimg:function(){var t=this,e=[];return Object.keys(this.itemInfo.totalTypes).forEach(function(i){e.push((0,r.replaceImage)(t.itemInfo.totalTypes[i].image))}),e.splice(0,4)},is_UserChoose:function(){if(Object.keys(this.itemInfo.totalTypes).length){var t=this.itemInfo.totalTypes[this.itemInfo.type];return void 0!==t&&t}return!1}})};e.default=y}).call(this,i("0de9")["default"],i("6e42")["default"])},"6cdb":function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=(t._self._c,Object.keys(t.itemInfo)),o=Object.keys(t.itemInfo),n=Object.keys(t.itemInfo),s=Object.keys(this.itemInfo.totalTypes),a=Object.keys(this.itemInfo.totalTypes),r=Object.keys(t.itemInfo),c=Object.keys(t.commont),u=Object.keys(t.commont),l=Object.keys(t.commont),f=Object.keys(t.itemInfo),h=Object.keys(t.itemInfo),p=Object.keys(t.itemInfo),m=Object.keys(t.itemInfo),d=t.__map(t.discount,function(e,i){var o=t.isCountClass(e),n=t.isCount(e);return{$orig:t.__get_orig(e),m0:o,m1:n}}),g=Object.keys(t.itemInfo),I=Object.keys(t.itemInfo),v=t.isChooseType();t.$mp.data=Object.assign({},{$root:{g0:i,g1:o,g2:n,g3:s,g4:a,g5:r,g6:c,g7:u,g8:l,g9:f,g10:h,g11:p,g12:m,l0:d,g13:g,g14:I,m2:v}})},n=[];i.d(e,"a",function(){return o}),i.d(e,"b",function(){return n})},"901f":function(t,e,i){"use strict";var o=i("afc0"),n=i.n(o);n.a},a113:function(t,e,i){"use strict";i.r(e);var o=i("6cdb"),n=i("ae5e");for(var s in n)"default"!==s&&function(t){i.d(e,t,function(){return n[t]})}(s);i("901f");var a=i("2877"),r=Object(a["a"])(n["default"],o["a"],o["b"],!1,null,null,null);e["default"]=r.exports},ae5e:function(t,e,i){"use strict";i.r(e);var o=i("409c"),n=i.n(o);for(var s in o)"default"!==s&&function(t){i.d(e,t,function(){return o[t]})}(s);e["default"]=n.a},afc0:function(t,e,i){},f1a2:function(t,e,i){"use strict";(function(t){i("20d5"),i("921b");o(i("66fd"));var e=o(i("a113"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("6e42")["createPage"])}},[["f1a2","common/runtime","common/vendor"]]]);