(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/ShopDetails/shopDetails"],{"25a9":function(e,t,i){"use strict";var o,n=function(){var e=this,t=e.$createElement,i=(e._self._c,Object.keys(e.itemInfo)),o=Object.keys(e.itemInfo),n=Object.keys(e.itemInfo),s=Object.keys(this.itemInfo.totalTypes),a=Object.keys(this.itemInfo.totalTypes),r=Object.keys(e.itemInfo),c=Object.keys(e.commont),u=Object.keys(e.commont),l=Object.keys(e.commont),f=Object.keys(e.itemInfo),p=Object.keys(e.itemInfo),h=Object.keys(e.itemInfo),m=Object.keys(e.itemInfo),d=e.__map(e.discount,function(t,i){var o=e.isCountClass(t),n=e.isCount(t);return{$orig:e.__get_orig(t),m0:o,m1:n}}),g=Object.keys(e.itemInfo),I=Object.keys(e.itemInfo),v=e.isChooseType();e.$mp.data=Object.assign({},{$root:{g0:i,g1:o,g2:n,g3:s,g4:a,g5:r,g6:c,g7:u,g8:l,g9:f,g10:p,g11:h,g12:m,l0:d,g13:g,g14:I,m2:v}})},s=[];i.d(t,"b",function(){return n}),i.d(t,"c",function(){return s}),i.d(t,"a",function(){return o})},"3b34":function(e,t,i){"use strict";(function(e,o){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,s=i("2f62"),a=i("2799"),r=i("6cba"),c=i("d383"),u=l(i("8f99"));function l(e){return e&&e.__esModule?e:{default:e}}function f(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},o=Object.keys(i);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),o.forEach(function(t){g(e,t,i[t])})}return e}function p(e){return d(e)||m(e)||h()}function h(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function m(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function d(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}function g(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var I=function(){return i.e("components/numberbox/numberbox").then(i.bind(null,"cee3"))},v=function(){return i.e("components/uni-popup/uni-popup").then(i.bind(null,"ae8a"))},y=function(){return i.e("components/rate/rate").then(i.bind(null,"5ab0"))},b=function(){return Promise.all([i.e("common/vendor"),i.e("components/jyf-Parser/index")]).then(i.bind(null,"e407"))},k={components:{uniPopup:v,tuiNumberbox:I,tuiRate:y,parser:b},data:function(){var e;return{payimgType:!0,swiperNum:0,videoUrl:"",swiperList:[],getCurrentList:[],list:[],value:1,shareList:[],itemInfo:(e={price:"",oldPrice:"",count:"",ficti:"",sales:0,cost:"",isHot:"",isPostage:!1,isSeckill:!1,isGroup:!1,userCollect:!1},g(e,"count",""),g(e,"name",""),g(e,"type",[]),g(e,"count",0),g(e,"totalTypes",[]),g(e,"image",""),g(e,"id",""),g(e,"stock",""),g(e,"unique",""),g(e,"id",""),g(e,"is_bargain",""),g(e,"video",""),g(e,"desc",""),e),storeInfo:{info:{expressageFen:"",produceFen:"",serviceFen:"",totalFen:0,storeName:"",storeLogo:"",storeId:"",totalFen2:2},shopFans:""},recommend:[],discount:{},autoplay:!1,commont:{},videoContext:"",hasData:!1}},onLoad:function(t){var i=this;t.id?(this.$store.commit("keepShopId",t.id),console.log(e(this.$store.state.shopId," at pages\\ShopDetails\\shopDetails.vue:391")),this._getDetailData(t.id)):o.switchTab({url:"../Home/home"}),this.$nextTick(function(){i.hasData||i.$refs.loading.open()})},onShow:function(){""==this.$store.state.shopId&&o.switchTab({url:"../Home/home"})},onUnload:function(){o.$off("videoDetail")},methods:{_getDetailData:function(t){var i=this;(0,a.getDetailData)(t).then(function(t){if(i.$refs.loading.close(),i.hasData=!0,200!=t.data.code)return plus.nativeUI.toast("数据错误，请重试"),void o.navigateBack();var n=t.data.data.storeInfo;n.slider_image=n.slider_image.map(function(e){return(0,r.replaceImage)(e)}),i.dealSwiper(n),i.itemInfo.desc=n.description,console.log(e(i.itemInfo.desc," at pages\\ShopDetails\\shopDetails.vue:456")),i.itemInfo.id=n.id,i.itemInfo.price=n.price,i.itemInfo.oldPrice=n.ot_price,i.itemInfo.count=parseInt(n.give_integral),i.itemInfo.ficti=n.ficti,i.itemInfo.cost=n.cost,i.itemInfo.isHot=n.is_hot,i.itemInfo.isPostage=n.is_postage,i.itemInfo.isSeckill=n.is_seckill,i.itemInfo.isGroup=n.is_group,i.itemInfo.userCollect=n.userCollect,i.itemInfo.name=n.store_name,i.itemInfo.sales=n.sales,i.itemInfo.image=(0,r.replaceImage)(n.image),i.itemInfo.stock=n.stock,i.itemInfo.is_group=n.is_group,i.itemInfo.is_bargain=n.is_bargain,i.itemInfo.video=(0,r.replaceImage)(n.video),o.$emit("page-detail",{video:i.itemInfo.video}),i.list=p(t.data.data.productAttr),i.itemInfo.totalTypes=t.data.data.productValue;var s=t.data.data.shop_info;i.storeInfo.info.expressageFen=s.expressage_score,i.storeInfo.info.produceFen=s.product_score,i.storeInfo.info.serviceFen=s.service_score,i.storeInfo.info.storeId=s.shop_id,i.storeInfo.info.storeLogo=(0,r.replaceImage)(s.shop_logo),i.storeInfo.info.storeName=s.shop_name,i.storeInfo.info.totalFen=s.zong,i.recommend=t.data.data.recommend_goods;(0,r.replaceList)(t.data.data.recommend_goods);i.recommend.forEach(function(e){e.image=(0,r.replaceImage)(e.image)}),i.getShopDiscount(i.storeInfo.info.storeId,i.isToken);var a=t.data.data.reply;i.dealCommont(a)})},dealSwiper:function(e){this.swiperList=e.slider_image.map(function(e,t){return{url:e,id:t,type:"image"}})},selectShopClick:function(e,t,i){e.check?e.check=!1:(this.list[i].attr_value.forEach(function(e){e.check=!1}),e.check=!0),this.itemInfo.type=[],this.getCurrent()},getCurrent:function(){var e=this;if(!this.list)return[];var t=this.list.map(function(e){return e.attr_value.filter(function(e){return e.check})});t.forEach(function(t){t.length&&e.itemInfo.type.push(t[0].attr)})},selectimageClick:function(){0==this.swiperNum&&(this.payimgType=!1,this.ZhanTing())},selectPlayClick:function(){0!=this.swiperNum&&(this.payimgType=!0,this.BoFang())},swiperChange:function(e){this.swiperNum=e.target.current},serviceClick:function(){if(this.isToken){var e=this.storeInfo.info,t={shop_name:e.shop_name,shop_logo:e.storeLogo,shop_id:e.storeId,product_score:e.produceFen,expressage_score:e.expressageFen,service_score:e.serviceFen,zong:e.totalFen};t=JSON.stringify(t),o.navigateTo({url:"informtion/informtion?shopInfo="+t})}else plus.nativeUI.toast("请先去登录哦")},change:function(e){this.value=e.value},goMoreCommont:function(){if(this.isToken){var e=this.itemInfo.id;o.navigateTo({url:"shopComment?id=".concat(e)})}else plus.nativeUI.toast("请先去登录哦")},nowBuyClick:function(){var t=this;if(this.isToken)if(Object.keys(this.itemInfo.totalTypes).length){var i=this.itemInfo.totalTypes[this.itemInfo.type];if(void 0!==i){this.itemInfo.unique=i.unique;var n={productId:this.itemInfo.id,cartNum:this.value,shop_id:this.storeInfo.info.storeId,uniqueId:this.itemInfo.unique,combinationId:"",secKillId:"",bargainId:""};(0,a.payNow)(n,this.isToken).then(function(i){if(console.log(e(i," at pages\\ShopDetails\\shopDetails.vue:636")),200==i.data.code){t.$store.commit("keepCartId",i.data.data.cartId);var n=t.$store.state.pinkInfo;Object.keys(n).length&&t.$store.commit("setOutPinkInfo"),o.navigateTo({url:"affirm/affirmOrder"})}else 400==i.data.code&&o.showToast({title:"商品不存在或已删除",icon:"none"})})}else o.showToast({title:"请选择商品种类",icon:"none"})}else{this.itemInfo.unique="";var s={productId:this.itemInfo.id,cartNum:this.value,shop_id:this.storeInfo.info.storeId,uniqueId:this.itemInfo.unique,combinationId:"",secKillId:"",bargainId:""};(0,a.payNow)(s,this.isToken).then(function(e){200==e.data.code?(t.$store.commit("keepCartId",e.data.data.cartId),o.navigateTo({url:"affirm/affirmOrder"})):400==e.data.code&&o.showToast({title:"商品不存在或已删除",icon:"none"})})}else o.switchTab({url:"../Home/home"})},swiperDetail:function(){var t=this.swiperList;t=t.map(function(e){return e.url}),console.log(e(t," at pages\\ShopDetails\\shopDetails.vue:704")),plus.nativeUI.previewImage(t)},openImage:function(){var e=this.showImgUrl||"";e&&plus.nativeUI.previewImage([e])},dealCommont:function(e){if(e){var t=e.pics.map(function(e){return(0,r.replaceImage)(e)});e.pics=t,e.avatar=(0,r.replaceImage)(e.avatar),this.commont=e}},collectClick:function(e){var t;this.isToken?(this.itemInfo.userCollect=!this.itemInfo.userCollect,this.itemInfo.isSeckill||this.itemInfo.isGroup||this.itemInfo.is_bargain?(this.itemInfo.isSeckill&&(t="seckill"),this.itemInfo.isGroup&&(t="pink"),this.itemInfo.bargain&&(t="bargain")):t="product",this.itemInfo.userCollect?(0,a.collectProduct)(this.itemInfo.id,t,this.isToken).then(function(e){e.data.code}):(0,a.unCollectProduct)(this.itemInfo.id,t,this.isToken).then(function(e){e.data.code})):plus.nativeUI.toast("请先去登录哦")},isClick:function(){o.navigateTo({url:"aaa"})},shopClick:function(){o.navigateTo({url:"StoreDetails/storedetails?id="+this.storeInfo.info.storeId})},outloginClick:function(){this.$refs.popups.open()},closePopupsClick:function(){this.$refs.popups.close()},goDetail:function(e){(0,c.clickDetail)(e)},outloginSharClick:function(){var t=this;if(this.isToken){var i=this,n={href:"http://jn.51kdd.com/index.html#/?href=oldHome://abc",title:"老家商城",desc:i.itemInfo.name,imgUrl:i.itemInfo.image},s=[{icon:"/static/sharemenu/wechatfriend.png",text:"微信好友"},{icon:"/static/sharemenu/wechatmoments.png",text:"朋友圈"},{icon:"/static/sharemenu/copyurl.png",text:"复制"},{icon:"/static/sharemenu/more.png",text:"更多"}];this.shareObj=(0,u.default)(n,s,function(t){console.log(e("点击按钮的序号: "+t," at pages\\ShopDetails\\shopDetails.vue:826"));var i={href:n.href||"",title:n.title||"",summary:n.desc||"",success:function(t){console.log(e("success:"+JSON.stringify(t)," at pages\\ShopDetails\\shopDetails.vue:832")),o.hideLoading()},fail:function(t){console.log(e("fail:"+JSON.stringify(t)," at pages\\ShopDetails\\shopDetails.vue:836")),o.hideLoading()}};switch(t){case 0:i.provider="weixin",i.scene="WXSceneSession",i.type=0,i.imageUrl=n.imgUrl||"",o.showLoading({title:"加载中...",mask:!0}),o.share(i);break;case 1:i.provider="weixin",i.scene="WXSenceTimeline",i.type=0,i.imageUrl=n.imgUrl||"",o.showLoading({title:"加载中...",mask:!0}),o.share(i);break;case 2:o.setClipboardData({data:n.href,complete:function(){o.showToast({title:"已复制到剪贴板"})}});break;case 3:plus.share.sendWithSystem({type:"web",title:n.title||"",thumbs:[n.imgUrl||""],href:n.href||"",content:n.desc||""});break}}),this.$nextTick(function(){t.shareObj.alphaBg.show(),t.shareObj.shareMenu.show()})}else plus.nativeUI.toast("请先去登录哦")},closePopupsSharClick:function(){this.$refs.popup.close()},outloginShopClick:function(){this.isToken?this.$refs.popupbottom.open():plus.nativeUI.toast("请先去登录哦")},closePopupsShopClick:function(){this.$refs.popupbottom.close()},chooseClose:function(){this.$refs.popupbottom.close()},recommClick:function(e,t){o.navigateTo({url:"./shopDetails?id=".concat(e.id)})},addCart:function(){var t=this;if(this.isToken)if(Object.keys(this.itemInfo.totalTypes).length){var i=this.itemInfo.totalTypes[this.itemInfo.type];if(void 0!==i){this.itemInfo.unique=i.unique;var n={productId:this.itemInfo.id,cartNum:this.value,uniqueId:this.itemInfo.unique,shop_id:this.storeInfo.info.storeId};(0,a.getAddCart)(n,this.isToken).then(function(i){console.log(e(i," at pages\\ShopDetails\\shopDetails.vue:941")),200==i.data.code&&(plus.nativeUI.toast("添加成功"),t.$store.commit("addCart",n))}),this.$refs.popupbottom.close()}else o.showToast({title:"请选择商品种类",icon:"none"})}else{this.itemInfo.unique="";var s={productId:this.itemInfo.id,cartNum:this.value,uniqueId:this.itemInfo.unique,shop_id:this.storeInfo.info.storeId};(0,a.getAddCart)(s,this.isToken).then(function(i){console.log(e(i," at pages\\ShopDetails\\shopDetails.vue:968")),200==i.data.code&&(plus.nativeUI.toast("添加成功"),t.$store.commit("addCart",s))}),this.$refs.popupbottom.close()}else o.navigateTo({url:"../login/login"})},isChooseType:function(){if(this.itemInfo.type){var e=this.itemInfo.type;return this.list.length==e.length?this.itemInfo.totalTypes[e]?this.itemInfo.totalTypes[e].suk:"":e.join(",")}return""},getShopDiscount:function(e,t){var i=this;(0,a.getShopDiscount)(e,t).then(function(e){200==e.data.code&&(i.discount=e.data.data)})},isCountClass:function(e){return!!e.is_use},isCount:function(e){return e.is_use?"已领取":1!=parseInt(e.is_permanent)?0==e.total_count?"已抢光":"立即领取":"已失效"},goLingqu:function(e){"立即领取"==this.isCount(e)&&(0,a.getDisCount)(e.id,this.isToken).then(function(t){200==t.data.code&&(e.is_use=!0,o.showToast({title:t.data.msg,icon:"none"}))})},BoFang:function(){if(0==this.autoplay){o.$emit("videoDetail",{video:this.itemInfo.video});var t=o.getSubNVueById("video_mask");t.show("fade-in",300,function(){console.log(e("打开成功"," at pages\\ShopDetails\\shopDetails.vue:1063"))})}},ZhanTing:function(){1==n.autoplay&&(n.autoplay=!1)}},computed:f({},(0,s.mapGetters)(["isToken"]),{isUserCollect:function(){return this.itemInfo.userCollect?"已收藏":"收藏"},isVideo:function(){return!this.swiperList.every(function(e){return"image"==e.type})},showImgUrl:function(){if(this.itemInfo.totalTypes)return this.itemInfo.type.length&&this.itemInfo.totalTypes[this.itemInfo.type.join(",")]?(0,r.replaceImage)(this.itemInfo.totalTypes[this.itemInfo.type.join(",")].image):(0,r.replaceImage)(this.itemInfo.image)},selectimg:function(){var e=this,t=[];return Object.keys(this.itemInfo.totalTypes).forEach(function(i){t.push((0,r.replaceImage)(e.itemInfo.totalTypes[i].image))}),t.splice(0,4)},is_UserChoose:function(){if(Object.keys(this.itemInfo.totalTypes).length){var e=this.itemInfo.totalTypes[this.itemInfo.type];return void 0!==e&&e}return!1}})};t.default=k}).call(this,i("0de9")["default"],i("6e42")["default"])},"694c":function(e,t,i){},"69b8":function(e,t,i){"use strict";(function(e){i("dead"),i("921b");o(i("66fd"));var t=o(i("be0d"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,i("6e42")["createPage"])},"9e49":function(e,t,i){"use strict";i.r(t);var o=i("3b34"),n=i.n(o);for(var s in o)"default"!==s&&function(e){i.d(t,e,function(){return o[e]})}(s);t["default"]=n.a},be0d:function(e,t,i){"use strict";i.r(t);var o=i("25a9"),n=i("9e49");for(var s in n)"default"!==s&&function(e){i.d(t,e,function(){return n[e]})}(s);i("c0cc");var a,r=i("f0c5"),c=Object(r["a"])(n["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],a);t["default"]=c.exports},c0cc:function(e,t,i){"use strict";var o=i("694c"),n=i.n(o);n.a}},[["69b8","common/runtime","common/vendor"]]]);