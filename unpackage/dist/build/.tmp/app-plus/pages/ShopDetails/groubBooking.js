(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/ShopDetails/groubBooking"],{"1a56":function(e,t,i){"use strict";(function(e){i("dead"),i("921b");o(i("66fd"));var t=o(i("ef7a"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,i("6e42")["createPage"])},"2f14":function(e,t,i){"use strict";i.r(t);var o=i("75c0"),n=i.n(o);for(var a in o)"default"!==a&&function(e){i.d(t,e,function(){return o[e]})}(a);t["default"]=n.a},"75c0":function(e,t,i){"use strict";(function(e,o){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,a,s=i("4ff4"),c=i("6cba"),u=p(i("8f99")),r=i("3dc2"),l=i("d383");function p(e){return e&&e.__esModule?e:{default:e}}function f(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},o=Object.keys(i);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),o.forEach(function(t){h(e,t,i[t])})}return e}function h(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var d=function(){return i.e("components/numberbox/numberbox").then(i.bind(null,"cee3"))},g=function(){return i.e("components/uni-popup/uni-popup").then(i.bind(null,"ae8a"))},m=function(){return i.e("components/countdown/countdown").then(i.bind(null,"ceca"))},k=function(){return i.e("components/rate/rate").then(i.bind(null,"5ab0"))},b={components:{uniPopup:g,tuiNumberbox:d,tuiCountdown:m,tuiRate:k},onLoad:function(){if(a=this,!this.$store.getters.isToken)return e.showModal({title:"请先去登录再来查看",success:function(t){t.confirm?e.navigateTo({url:"../login/login"}):e.navigateTo({url:"../Home/home"})}}),!1;if(this.$store.state.combinId){var t=this.$store.state.combinId,i=this.$store.getters.isToken;this.getPinkDetail(t,i)}else e.switchTab({url:"../Home/home"})},onShow:function(){this.pinkInfo={},this.isPink=!1},data:function(){return{payimgType:!0,timeList:[1e3,2e3,3e3,19,24e4],swiperNum:0,videoUrl:"",swiperList:[],selectimg:[],list:[],value:1,detailData:{},autoplay:!1,pinkInfo:{},uniqueType:"",isPink:!1,commont:{},msg:[]}},onBackPress:function(){if(nvImageMenu.isVisible())return nvImageMenu.hide(),nvMask.hide(),!0},onReady:function(){this.$refs.loading.open()},methods:(n={showAllTuan:function(){this.$refs.booking.open()},getPinkDetail:function(t,i){var o=this;(0,s.getPinkDetail)(t,i).then(function(t){if(o.$refs.loading.close(),200==t.data.code){var i=t.data.data;i.recommend_goods.forEach(function(e){e.image=(0,c.replaceImage)(e.image)}),i.storeInfo.image=(0,c.replaceImage)(i.storeInfo.image),i.storeInfo.images=i.storeInfo.images.map(function(e){return(0,c.replaceImage)(e)}),i.storeInfo.video=(0,c.replaceImage)(i.storeInfo.video),o.videoUrl=i.storeInfo.video,o.videoUrl&&(o.videoContext=e.createVideoContext("myVideo",o)),o.dealSwiper(i),i.productValue&&o.dealProductValue(i),i.pink.length&&o.detalPink(i.pink);var n=i.reply;o.dealCommont(n),o.msg=i.pink_ok_list,o.detailData=f({},i)}})},dealSwiper:function(e){if(this.swiperList=e.storeInfo.images.map(function(e,t){return{url:e,id:t,type:"image"}}),e.storeInfo.video){var t={url:e.storeInfo.video,id:0,type:"video"};this.swiperList.unshift(t)}},detalPink:function(e){var t=this;e.forEach(function(e){t.$set(e,"avatar","http://"+r.HOST+e.avatar),t.$set(e,"time",t.dealTime(e))})},dealCommont:function(e){if(e){var t=e.pics.map(function(e){return(0,c.replaceImage)(e)});e.pics=t,e.avatar=(0,c.replaceImage)(e.avatar),this.commont=e}},dealProductValue:function(e){var t=e.productValue,i=Object.keys(t);i.forEach(function(e,i){var o=(0,c.replaceImage)(t[e].image);t[e].image=o})},openImage:function(){var e=this.uniqueType?this.uniqueType.price:this.detailData.storeInfo.price;e&&plus.nativeUI.previewImage([e])},selectShopClick:function(e,t,i){if(e.check)return e.check=!1,void(this.uniqueType="");i.attr_value.forEach(function(e){e.check=!1}),e.check=!0;var n=[];this.detailData.productAttr.forEach(function(e){e.attr_value.forEach(function(e){e.check&&n.push(e.attr)})}),console.log(o(n," at pages\\ShopDetails\\groubBooking.vue:558")),(n.length=this.detailData.productAttr.length)&&(this.uniqueType=this.detailData.productValue[n.join(",")])},selectimageClick:function(){0==this.swiperNum&&(this.payimgType=!1,this.ZhanTing())},selectPlayClick:function(){0!=this.swiperNum&&(this.payimgType=!0,this.BoFang())}},h(n,"openImage",function(){var e=this.uniqueType?this.uniqueType.image:this.detailData.storeInfo.image;e&&plus.nativeUI.previewImage([e])}),h(n,"swiperChange",function(e){this.swiperNum=e.target.current}),h(n,"serviceClick",function(t){var i=JSON.stringify(this.detailData.shop_info);e.navigateTo({url:"informtion/informtion?shopInfo="+i})}),h(n,"change",function(e){this.value=e.value}),h(n,"chooseImg",function(){}),h(n,"nowBuyClick",function(){var t=this;if(0==Object.keys(this.detailData.productValue).length||""!=this.uniqueType){var i=this.detailData,o={productId:i.storeInfo.id,cartNum:this.value,uniqueId:this.uniqueType?this.uniqueType.unique:"",combinationId:i.storeInfo.id,secKillId:"",bargainId:"",shop_id:i.storeInfo.shop_id};this.$store.dispatch("Pay",o).then(function(i){200==i.data.code?(t.$store.commit("keepCartId",i.data.data.cartId),t.isPink?t.$store.commit("setPinkId",t.pinkInfo):t.$store.commit("setOutPinkInfo"),t.$refs.bookingsingle.close(),t.$refs.popupbottom.close(),e.navigateTo({url:"affirm/affirmOrder"})):e.showToast({title:i.data.msg,icon:"none"})})}else e.showToast({title:"请选择商品种类",icon:"none"})}),h(n,"joinPintuan",function(){this.isPink=!0,0!=Object.keys(this.detailData.productValue).length&&""!=this.uniqueType?this.nowBuyClick():(this.$refs.popupbottom.open(),this.$refs.bookingsingle.close())}),h(n,"openSingle",function(e){this.pinkInfo=e,this.$refs.booking.close(),this.$refs.bookingsingle.open()}),h(n,"collectClick",function(){this.detailData.storeInfo.userCollect=!this.detailData.storeInfo.userCollect;var e={id:this.detailData.storeInfo.id,category:"pink_product"};this.detailData.storeInfo.userCollect?this.$store.dispatch("collect",e).then(function(e){e.data.code}):this.$store.dispatch("unCollect",e).then(function(e){console.log(o(e," at pages\\ShopDetails\\groubBooking.vue:685")),e.data.code})}),h(n,"shopClick",function(t){e.navigateTo({url:"StoreDetails/storedetails?id="+this.detailData.storeInfo.shop_id})}),h(n,"outloginClick",function(){this.$refs.popups.open()}),h(n,"closePopupsClick",function(){this.$refs.popups.close()}),h(n,"outloginSharClick",function(){var t=this,i=this,n=i.detailData.storeInfo.title,a={href:"http://jn.51kdd.com/index.html#/?href=oldHome://abc",title:"老家商城",desc:"我正在老家商城购买"+n+",快来和我一起选购吧",imgUrl:i.detailData.storeInfo.image},s=[{icon:"/static/sharemenu/wechatfriend.png",text:"微信好友"},{icon:"/static/sharemenu/wechatmoments.png",text:"朋友圈"},{icon:"/static/sharemenu/copyurl.png",text:"复制"},{icon:"/static/sharemenu/more.png",text:"更多"}];this.shareObj=(0,u.default)(a,s,function(t){console.log(o("点击按钮的序号: "+t," at pages\\ShopDetails\\groubBooking.vue:734"));var i={href:a.href||"",title:a.title||"",summary:a.desc||"",success:function(e){console.log(o("success:"+JSON.stringify(e)," at pages\\ShopDetails\\groubBooking.vue:740"))},fail:function(e){console.log(o("fail:"+JSON.stringify(e)," at pages\\ShopDetails\\groubBooking.vue:743"))}};switch(t){case 0:i.provider="weixin",i.scene="WXSceneSession",i.type=0,i.imageUrl=a.imgUrl||"",e.share(i);break;case 1:i.provider="weixin",i.scene="WXSenceTimeline",i.type=0,i.imageUrl=a.imgUrl||"",e.share(i);break;case 2:e.setClipboardData({data:a.href,complete:function(){e.showToast({title:"已复制到剪贴板"})}});break;case 3:plus.share.sendWithSystem({type:"web",title:a.title||"",thumbs:[a.imgUrl||""],href:a.href||"",content:a.desc||""});break}}),this.$nextTick(function(){t.shareObj.alphaBg.show(),t.shareObj.shareMenu.show()})}),h(n,"closePopupsSharClick",function(){this.$refs.popup.close()}),h(n,"outloginShopClick",function(){this.$refs.popupbottom.open()}),h(n,"closePopupsShopClick",function(){this.$refs.popupbottom.close()}),h(n,"outloginbookingClick",function(){this.detailData.pindAll.length?this.$refs.booking.open():this.$refs.popupbottom.open()}),h(n,"closePopupsbookingClick",function(){this.$refs.booking.close()}),h(n,"outloginbookingsingleClick",function(){this.$refs.bookingsingle.open()}),h(n,"closePopupsbookingsingleClick",function(){this.$refs.bookingsingle.close()}),h(n,"chooseClose",function(){this.$refs.popupbottom.close()}),h(n,"BoFang",function(){0==a.autoplay&&(a.autoplay=!0,this.videoContext.play())}),h(n,"ZhanTing",function(){1==a.autoplay&&(a.autoplay=!1)}),h(n,"recommendClick",function(t){e.navigateTo({url:"shopDetails?id=".concat(t.id)})}),h(n,"shareShowClick",function(t,i){"微信好友"==t.name&&e.share({provider:"weixin",scene:"WXSceneSession",type:0,href:"https://baidu.com",title:"老家商城分享",summary:"我正在使用老家商城购物，赶紧跟我一起来体验！",imageUrl:"../../../static/demo5.png",success:function(e){console.log(o("success:"+JSON.stringify(e)," at pages\\ShopDetails\\groubBooking.vue:853"))},fail:function(e){console.log(o("fail:"+JSON.stringify(e)," at pages\\ShopDetails\\groubBooking.vue:856"))}})}),h(n,"dealTime",function(e){var t=e.h,i=e.i,o=e.s;return 60*t*60+60*i+1*o}),h(n,"swiperDetail",function(){var e=this.swiperList.slice(1,this.swiperList.length-1);e=e.map(function(e){return e.url}),console.log(o(e," at pages\\ShopDetails\\groubBooking.vue:869")),plus.nativeUI.previewImage(e)}),h(n,"sharkPink",function(e){this.joinPintuan()}),h(n,"popupChoose",function(){return Object.keys(this.detailData.productValue).length?"已选择："+(this.uniqueType?this.uniqueType.suk:""):"默认种类"}),h(n,"goPink",function(){if(this.detailData.pink.length){if(0!=Object.keys(this.detailData.productValue).length&&""==this.uniqueType)return void e.showToast({title:"请选择商品种类",icon:"none"});Object.keys(this.pinkInfo).length?(this.isPink=!0,this.nowBuyClick()):this.$refs.booking.open()}else e.showToast({title:"还没有人发起拼团哦~",icon:"none"})}),h(n,"goDetail",function(e){(0,l.clickDetail)(e)}),h(n,"goKaituan",function(){this.isPink=!1,this.nowBuyClick()}),h(n,"goMoreCommont",function(){var t=this.detailData.storeInfo.product_id;e.navigateTo({url:"shopComment?id=".concat(t)})}),h(n,"tanchuPin",function(){this.detailData.pink.length?this.outloginShopClick():e.showToast({title:"还没有人发起拼团哦~",icon:"none"})}),n)};t.default=b}).call(this,i("6e42")["default"],i("0de9")["default"])},"7e4c":function(e,t,i){},b47c:function(e,t,i){"use strict";var o=i("7e4c"),n=i.n(o);n.a},ecea:function(e,t,i){"use strict";var o=function(){var e=this,t=e.$createElement,i=(e._self._c,Object.keys(e.detailData)),o=Object.keys(e.detailData.productValue),n=Object.keys(e.commont),a=Object.keys(e.commont),s=Object.keys(e.commont),c=e.popupChoose(),u=Object.keys(e.detailData);e.$mp.data=Object.assign({},{$root:{g0:i,g1:o,g2:n,g3:a,g4:s,m0:c,g5:u}})},n=[];i.d(t,"a",function(){return o}),i.d(t,"b",function(){return n})},ef7a:function(e,t,i){"use strict";i.r(t);var o=i("ecea"),n=i("2f14");for(var a in n)"default"!==a&&function(e){i.d(t,e,function(){return n[e]})}(a);i("b47c");var s=i("2877"),c=Object(s["a"])(n["default"],o["a"],o["b"],!1,null,null,null);t["default"]=c.exports}},[["1a56","common/runtime","common/vendor"]]]);